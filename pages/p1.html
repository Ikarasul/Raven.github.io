<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="RavenPort - à¸£à¸°à¸šà¸šà¸ˆà¸±à¸”à¸à¸²à¸£à¸žà¸­à¸£à¹Œà¸•à¹‚à¸Ÿà¸¥à¸´à¹‚à¸­à¹à¸¥à¸°à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸™à¸±à¸à¸¨à¸¶à¸à¸©à¸²">
    <meta name="theme-color" content="#10b981">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Raven.Space</title>

    <!-- Performance: Preconnect to CDNs -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- ðŸŽ„ Christmas Theme (Optional) -->
    <link rel="stylesheet" href="../css/christmas-theme.css">
    <script src="../js/christmas-effects.js" defer></script>

    <!-- Core Scripts -->
    <script src="../js/auth-check.js"></script>
    <script src="../js/theme.js"></script>
    <script src="../js/nav.js"></script>
    <script src="../js/finance.js"></script>
    <script src="../js/weather.js" defer></script>

    <style>
        body {
            background-color: #f1f5f9;
            font-family: 'Outfit', sans-serif;
            color: #334155;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ANIMATED BACKGROUND */
        .aurora-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background:
                radial-gradient(at 0% 0%, rgba(167, 243, 208, 0.45) 0px, transparent 50%),
                radial-gradient(at 100% 0%, rgba(196, 181, 253, 0.45) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(251, 207, 232, 0.4) 0px, transparent 50%),
                radial-gradient(at 0% 100%, rgba(254, 215, 170, 0.4) 0px, transparent 50%);
            background-size: 400% 400%;
            animation: auroraMove 15s ease infinite, auroraColors 30s ease-in-out infinite;
        }

        @keyframes auroraMove {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        @keyframes auroraColors {
            0% {
                filter: hue-rotate(0deg) brightness(1);
            }

            25% {
                filter: hue-rotate(30deg) brightness(1.05);
            }

            50% {
                filter: hue-rotate(60deg) brightness(1.1);
            }

            75% {
                filter: hue-rotate(30deg) brightness(1.05);
            }

            100% {
                filter: hue-rotate(0deg) brightness(1);
            }
        }

        /* Nav handled by nav.js */

        .stack-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem 1.5rem 6rem;
        }

        @media (max-width: 640px) {
            .stack-container {
                padding: 2rem 1rem calc(60px + 3rem);
            }
        }

        @media (min-width: 641px) and (max-width: 1024px) {
            .stack-container {
                padding: 2rem 1.25rem 5rem;
            }
        }

        /* LUMINOUS CARD */
        .lumi-card {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            border-radius: 2rem;
            padding: 2rem;
            box-shadow:
                0 4px 6px -1px rgba(0, 0, 0, 0.02),
                0 2px 4px -1px rgba(0, 0, 0, 0.02),
                inset 0 0 0 1px rgba(255, 255, 255, 0.4);
            transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
            position: relative;
            overflow: hidden;
        }

        .lumi-card:hover {
            transform: translateY(-5px) scale(1.01);
            background: rgba(255, 255, 255, 0.85);
            box-shadow:
                0 20px 25px -5px rgba(0, 0, 0, 0.05),
                0 10px 10px -5px rgba(0, 0, 0, 0.01),
                inset 0 0 0 1px rgba(255, 255, 255, 0.6);
        }

        /* Sections */
        .section-title {
            font-size: clamp(0.813rem, 2vw, 0.875rem);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #64748b;
            margin-bottom: 1.25rem;
            margin-left: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        @media (max-width: 640px) {
            .section-title {
                margin-bottom: 1rem;
                margin-left: 0.25rem;
            }
        }

        /* Project Strip */
        .project-strip {
            display: flex;
            gap: 1.5rem;
            overflow-x: auto;
            padding-bottom: 2rem;
            margin: 0 -1.5rem;
            padding: 0 1.5rem 2rem;
            scrollbar-width: thin;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
        }

        @media (max-width: 640px) {
            .project-strip {
                gap: 1rem;
                margin: 0 -1rem;
                padding: 0 1rem 1.5rem;
            }
        }

        .project-strip::-webkit-scrollbar {
            height: 6px;
        }

        .project-strip::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
        }

        .project-strip::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.15);
            border-radius: 10px;
        }

        .proj-pill {
            min-width: 300px;
            height: 220px;
            border-radius: 1.75rem;
            background: white;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            scroll-snap-align: start;
        }

        @media (max-width: 640px) {
            .proj-pill {
                min-width: 280px;
                height: 200px;
            }
        }

        .proj-pill:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 32px rgba(0, 0, 0, 0.12);
        }

        .proj-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.6), transparent 60%);
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 1.5rem;
        }

        /* GRID */
        .control-grid {
            display: grid;
            gap: 1.25rem;
        }

        /* Mobile: 2 columns */
        @media (max-width: 640px) {
            .control-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
        }

        /* Tablet: 3 columns */
        @media (min-width: 641px) and (max-width: 1024px) {
            .control-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 1.25rem;
            }
        }

        /* Desktop: 4 columns */
        @media (min-width: 1025px) {
            .control-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 1.5rem;
            }
        }

        /* Action Button */
        .action-btn {
            aspect-ratio: 1/1;
            border-radius: 1.75rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            gap: 0.75rem;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.8);
            background: rgba(255, 255, 255, 0.7);
        }

        .action-btn:hover {
            background: white;
            border-color: white;
        }

        .btn-icon {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            transition: transform 0.2s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .action-btn:hover .btn-icon {
            transform: scale(1.1) rotate(10deg);
        }
    </style>
</head>

<body class="selection:bg-pink-400 selection:text-white">

    <div class="aurora-bg animate-fade-in"></div>

    <!-- Nav injected by nav.js -->

    <div class="stack-container animate-enter">

        <!-- 1. HERO -->
        <div class="text-center mb-10">
            <div class="inline-block p-1 bg-white/50 backdrop-blur rounded-full mb-5 border border-white/50 shadow-sm">
                <img src="../assets/hero_student.png" class="w-20 h-20 md:w-24 md:h-24 rounded-full object-cover">
            </div>
            <h1 class="text-4xl md:text-5xl font-black text-slate-800 tracking-tight mb-3" data-i18n="p1_title">
                Hello, Raven.
            </h1>
            <p class="text-lg md:text-xl text-slate-500 font-medium max-w-lg mx-auto mb-6" data-i18n="p1_subtitle">
                Welcome to your personal creative space.
            </p>

            <!-- Quick Actions -->
            <div class="flex justify-center gap-4 mt-6">
                <button
                    class="px-6 py-2.5 bg-slate-800 text-white rounded-full font-bold shadow-lg shadow-slate-800/20 hover:bg-slate-700 transition-all flex items-center gap-2"
                    onclick="window.location.href='pages/p5.html'">
                    <i data-lucide="user" width="16"></i> <span data-i18n="p1_about_me">About Me</span>
                </button>
            </div>
        </div>

        <!-- 2. PORTFOLIO SCROLL -->
        <div class="mb-12">
            <div class="section-title">
                <i data-lucide="sparkles" width="16" class="text-amber-500"></i>
                <span data-i18n="p1_recent_creations">Recent Creations</span>
            </div>

            <div class="project-strip" id="lumi-projects">
                <!-- JS Injected -->
            </div>
        </div>

        <!-- 3. CONTROL DECK -->
        <div class="mb-12">
            <div class="section-title">
                <i data-lucide="layout-grid" width="16" class="text-indigo-500"></i>
                <span data-i18n="nav_dashboard">Dashboard</span>
            </div>

            <div class="control-grid">

                <!-- Schedule -->
                <a href="pages/P2.html" class="lumi-card action-btn group">
                    <div class="btn-icon bg-gradient-to-br from-blue-400 to-blue-600">
                        <i data-lucide="calendar"></i>
                    </div>
                    <div>
                        <div class="font-bold text-slate-800" data-i18n="nav_schedule">Schedule</div>
                        <div class="text-[10px] text-slate-500 font-bold uppercase mt-1" data-i18n="nav_schedule_desc">2
                            Classes</div>
                    </div>
                </a>

                <!-- Wallet -->
                <a href="pages/p3.html" class="lumi-card action-btn group">
                    <div class="btn-icon bg-gradient-to-br from-emerald-400 to-emerald-600">
                        <i data-lucide="wallet"></i>
                    </div>
                    <div>
                        <div class="font-bold text-slate-800" data-i18n="nav_money">Wallet</div>
                        <div class="text-[10px] text-slate-500 font-bold uppercase mt-1" id="wallet-preview">Loading...
                        </div>
                    </div>
                </a>

                <!-- Portal -->
                <a href="pages/p4.html" class="lumi-card action-btn group">
                    <div class="btn-icon bg-gradient-to-br from-orange-400 to-orange-600">
                        <i data-lucide="globe"></i>
                    </div>
                    <div>
                        <div class="font-bold text-slate-800" data-i18n="p4_title">Portal</div>
                        <div class="text-[10px] text-slate-500 font-bold uppercase mt-1" data-i18n="nav_portal_desc">
                            Services</div>
                    </div>
                </a>

                <!-- Focus -->
                <a href="pages/p6.html" class="lumi-card action-btn group">
                    <div class="btn-icon bg-gradient-to-br from-rose-400 to-rose-600">
                        <i data-lucide="zap"></i>
                    </div>
                    <div>
                        <div class="font-bold text-slate-800" data-i18n="p6_title">Focus</div>
                        <div class="text-[10px] text-slate-500 font-bold uppercase mt-1" data-i18n="nav_focus_desc">
                            Timer</div>
                    </div>
                </a>

            </div>
        </div>

        <!-- 4. WIDGET STACK -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

            <!-- Weather Frame -->
            <!-- Weather Frame -->
            <div class="lumi-card flex items-center justify-between transition-colors duration-500" id="w-card">
                <div>
                    <div class="flex items-center gap-2 mb-1 text-slate-400 uppercase text-xs font-bold" id="w-loc-box">
                        <i data-lucide="map-pin" width="12"></i> <span id="w-loc">Loading...</span>
                    </div>
                    <div class="text-4xl font-black text-slate-800" id="w-temp-box"><span id="w-temp-val">--</span>Â°
                    </div>
                    <div class="text-xs font-bold text-slate-500" id="w-desc">...</div>

                    <!-- Wind info -->
                    <div id="w-wind-box" class="mt-2 text-[10px] font-bold text-slate-400 items-center gap-1 hidden">
                        <i data-lucide="wind" width="10"></i> <span id="w-wind-val">0</span> km/h
                    </div>
                </div>
                <div class="w-16 h-16 text-slate-300" id="w-main-icon">
                    <i data-lucide="loader" width="64" height="64" class="animate-spin"></i>
                </div>
            </div>

            <!-- Context Update with TABS (Loaded by updates.js) -->
            <div id="updates-widget-container"></div>
        </div>
    </div>

    <!-- UPDATE MODAL (Loaded by updates.js) -->
    <div id="updates-modal-container"></div>
    <script src="../js/updates.js" defer></script>

    <!-- Chatbot attached -->
    <div id="chatbot-container"></div>
    <script src="../js/chatbot.js" defer></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();

            // Projects
            const container = document.getElementById('lumi-projects');
            const profile = JSON.parse(localStorage.getItem('raven_profile')) || {};
            const projects = (profile.projects && profile.projects.length > 0) ? profile.projects : [
                { name: "à¸žà¸­à¸£à¹Œà¸•à¹‚à¸Ÿà¸¥à¸´à¹‚à¸­ V7", desc: "à¸ªà¸”à¹ƒà¸ª & à¸—à¸±à¸™à¸ªà¸¡à¸±à¸¢", img: "https://images.unsplash.com/photo-1517694712202-14dd9538aa97?auto=format&fit=crop&q=80&w=600", link: "#" },
                { name: "E-Commerce API", desc: "Node.js Microservice", img: "https://images.unsplash.com/photo-1558494949-ef010cbdcc31?auto=format&fit=crop&q=80&w=600", link: "#" }
            ];

            container.innerHTML = projects.map(p => `
                <div class="proj-pill group" onclick="window.open('${p.link || '#'}')">
                    <img src="${p.img || 'https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?auto=format&fit=crop&q=80&w=600'}" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                    <div class="proj-overlay">
                        <h4 class="text-white font-bold text-xl">${p.name}</h4>
                        <span class="text-white/80 text-xs font-bold uppercase tracking-wider">${p.desc}</span>
                    </div>
                </div>
            `).join('');
            lucide.createIcons();

            // GUEST MODE CHECK (Index Specific)
            const isGuest = localStorage.getItem('isGuest') === 'true';
            if (isGuest) {
                // Hide Dashboard Section
                const dashboardParams = document.querySelectorAll('.section-title');
                // Find "Dashboard" title and hide it + next sibling (grid)
                // A better way is to wrap Dashboard in a ID, but since I can't easily edit the whole file structure without big context, 
                // I will target the Grid directly if unique, or use text content.
                // The dashboard grid has class 'control-grid'.
                const controlGrid = document.querySelector('.control-grid');
                if (controlGrid) {
                    controlGrid.style.display = 'none';
                    // Also hide the title above it
                    if (controlGrid.previousElementSibling && controlGrid.previousElementSibling.classList.contains('section-title')) {
                        controlGrid.previousElementSibling.style.display = 'none';
                    }
                    if (controlGrid.parentElement && controlGrid.parentElement.classList.contains('mb-12')) {
                        controlGrid.parentElement.style.display = 'none';
                    }
                }

                // Hide "Recent Creations" if wanted? User only said "Control Panel / Dashboard".
                // User said: "In Index ... see just P2, Profile, Workflows until login".
                // This implies "Recent Creations" might also need hiding if not P2/Profile/Workflows.
                // But specifically said "Index Control Panel Hide". I'll stick to that.

                // Also update Hero Text?
                const heroTitle = document.querySelector('h1[data-i18n="p1_title"]');
                if (heroTitle) heroTitle.innerText = "Welcome, Guest!";
                const heroSub = document.querySelector('p[data-i18n="p1_subtitle"]');
                if (heroSub) heroSub.innerText = "Please login to access full features.";
            }
            // Wallet Preview
            const updateWalletPreview = () => {
                if (window.RavenFinance) {
                    const summary = window.RavenFinance.getSummary();
                    const el = document.getElementById('wallet-preview');
                    if (el) el.innerText = `à¸¿${summary.formatted.total}`;
                }
            };

            // Init & Listen
            updateWalletPreview();
            window.addEventListener('raven-finance-update', updateWalletPreview);
        });
    </script>
</body>

</html>