<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="RavenPort - ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÇ‡∏ü‡∏•‡∏¥‡πÇ‡∏≠‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß">
    <meta name="theme-color" content="#10b981">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Profile - RavenPort</title>


    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="../js/auth-check.js"></script>
    <script src="../js/theme.js"></script>
    <script src="../js/nav.js"></script>


    <link rel="stylesheet" href="../css/christmas-theme.css">
    <script src="../js/christmas-effects.js" defer></script>


    <style>
        body {
            background-color: #f3f2ef;

            color: #1a1a1a;
            font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            overflow-x: hidden;
        }


        .card-modern {
            background: white;
            border-radius: 1rem;

            border: 1px solid #f1f5f9;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .card-modern:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.1);
            border-color: #e2e8f0;
        }


        nav {
            position: sticky;
            top: 0;
            z-index: 40;
            background: rgba(255, 255, 255, 0.8) !important;
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(226, 232, 240, 0.6);
            padding-top: 0.75rem !important;
            padding-bottom: 0.75rem !important;
        }


        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 20px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
</head>

<body class="selection:bg-indigo-500 selection:text-white pb-20">

    <div class="aurora-bg animate-fade-in"></div>



    <nav class="max-w-5xl mx-auto p-6 flex justify-end items-center">

    </nav>



    <div class="max-w-[1128px] mx-auto px-4 sm:px-6 lg:px-8 py-8 grid grid-cols-1 md:grid-cols-12 gap-8">


        <div id="profile-main-col" class="md:col-span-8 space-y-4">


            <div class="card-modern relative overflow-hidden pb-4">

                <div id="p-cover" class="h-48 w-full bg-cover bg-center bg-no-repeat relative"
                    style="background-image: url('https://images.unsplash.com/photo-1579546929518-9e396f3cc809?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80');">
                    <button onclick="openEditModal()"
                        class="absolute top-4 right-4 w-8 h-8 bg-white/50 hover:bg-white rounded-full flex items-center justify-center backdrop-blur-sm transition-all text-slate-700">
                        <i data-lucide="pencil" width="14"></i>
                    </button>
                </div>

                <div class="px-6 md:px-8 relative">

                    <div
                        class="w-40 h-40 rounded-full border-[6px] border-white -mt-24 relative z-10 bg-white overflow-hidden shadow-sm">
                        <img src="../assets/hero_student.png" alt="Profile" class="w-full h-full object-cover">
                    </div>


                    <div class="mt-4 flex flex-col md:flex-row justify-between items-start gap-4">
                        <div>
                            <h1 id="p-name" class="text-2xl font-bold text-slate-900 leading-tight">Raven</h1>
                            <p id="p-tagline" class="text-base text-slate-600 mt-1">Building Digital Experiences</p>

                            <div class="flex items-center gap-2 mt-2 text-sm text-slate-500">
                                <span class="flex items-center gap-1"><i data-lucide="map-pin" width="14"></i> <span
                                        data-i18n="p5_loc">
                                    </span>Bangkok, Thailand</span></span>
                                <span class="text-blue-600 font-bold hover:underline cursor-pointer"
                                    data-i18n="p5_contact">Contact info</span>
                            </div>

                            <div class="mt-4 flex flex-wrap gap-2">
                                <span id="p-tag1"
                                    class="px-3 py-1 rounded-full bg-blue-50 text-blue-700 text-sm font-semibold hover:underline cursor-pointer">#Developer</span>
                                <span id="p-tag2"
                                    class="px-3 py-1 rounded-full bg-emerald-50 text-emerald-700 text-sm font-semibold hover:underline cursor-pointer">#Student</span>
                                <span id="p-tag3"
                                    class="px-3 py-1 rounded-full bg-purple-50 text-purple-700 text-sm font-semibold hover:underline cursor-pointer">#Design</span>
                            </div>
                        </div>


                        <div class="hidden md:flex items-center gap-3 mt-2">
                            <div
                                class="w-10 h-10 bg-orange-50 rounded-lg flex items-center justify-center font-bold text-orange-600 border border-orange-100">
                                S</div>
                            <span class="text-sm font-bold text-slate-700 hover:text-blue-600 cursor-pointer"
                                data-i18n="p5_uni">Sripatum
                                University</span>
                        </div>
                    </div>


                    <div class="mt-4 flex gap-3 pb-2 relative">
                        <button onclick="toggleOpenWork()" id="btn-open-work"
                            class="px-6 py-1.5 rounded-full bg-blue-600 text-white font-bold text-sm hover:bg-blue-700 transition w-full md:w-auto shadow-sm shadow-blue-200"
                            data-i18n="p5_open_work">Open
                            to work</button>
                        <button onclick="openEditModal()"
                            class="px-6 py-1.5 rounded-full border border-blue-600 text-blue-600 font-bold text-sm hover:bg-blue-50 transition w-full md:w-auto"
                            data-i18n="p5_edit_profile">Edit
                            profile</button>
                        <button onclick="openMoreMenu()"
                            class="px-4 py-1.5 rounded-full border border-slate-400 text-slate-600 font-bold text-sm hover:bg-slate-100 transition"
                            data-i18n="p5_more">More</button>
                    </div>
                </div>
            </div>


            <div class="card-modern p-6 md:p-8">
                <div class="flex justify-between items-center mb-3">
                    <h2 class="text-xl font-bold text-slate-900" data-i18n="p5_about_title">About</h2>
                    <button onclick="openAboutModal()" class="text-slate-400 hover:text-slate-700"><i
                            data-lucide="pencil" width="16"></i></button>
                </div>
                <p id="p-bio" class="text-sm text-slate-700 leading-relaxed whitespace-pre-line">
                    Passionate computer science student...
                </p>
            </div>



            <div class="card-modern p-6 md:p-8">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-slate-900" data-i18n="p5_projects_title">Featured</h2>
                    <div class="flex gap-4">
                        <button onclick="openProjectModal()"
                            class="text-slate-400 hover:text-blue-600 font-bold text-sm flex items-center gap-1"><i
                                data-lucide="plus" width="16"></i> <span data-i18n="p5_add">Add</span></button>
                        <button onclick="openProjectModal()" class="text-slate-400 hover:text-slate-700"><i
                                data-lucide="pencil" width="16"></i></button>
                    </div>
                </div>

                <div id="p-projects" class="grid grid-cols-1 md:grid-cols-2 gap-4">

                </div>
            </div>



            <div class="card-modern p-6 md:p-8">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold text-slate-900" data-i18n="p5_exp_title">Experience</h2>
                    <button onclick="openExpModal()" id="btn-add-exp" class="text-slate-400 hover:text-slate-700"><i
                            data-lucide="plus" width="16"></i></button>
                </div>

                <div id="p-exp" class="space-y-4">

                </div>
            </div>

        </div>


        <div class="md:col-span-4 space-y-4">


            <div class="card-modern p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold text-slate-900" data-i18n="p5_skills_title">Skills</h2>
                    <div class="flex gap-2">
                        <button onclick="openEditModal()" class="text-slate-400 hover:text-blue-600 font-bold text-sm"
                            data-i18n="p5_demo">Demonstrate</button>
                        <button onclick="openSkillsModal()" class="text-slate-400 hover:text-slate-700"><i
                                data-lucide="pencil" width="14"></i></button>
                    </div>
                </div>
                <div id="p-skills" class="flex flex-wrap gap-2">

                </div>
            </div>




            <div class="card-modern p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold text-slate-900" data-i18n="p5_upcoming">Activity</h2>
                    <button onclick="openApptModal()" class="text-slate-400 hover:text-slate-700"><i data-lucide="plus"
                            width="16"></i></button>
                </div>
                <div id="appt-list" class="space-y-4">

                </div>
                <div class="mt-4 border-t border-slate-100 pt-3 text-center">
                    <button onclick="showFullSchedule()"
                        class="text-sm font-bold text-slate-500 hover:text-slate-700 flex items-center justify-center gap-1 mx-auto"
                        data-i18n="p5_show_schedule">Show all schedule <i data-lucide="arrow-right"
                            width="14"></i></button>
                </div>
            </div>

        </div>

    </div>



    <div id="edit-modal" class="fixed inset-0 z-[60] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm" onclick="closeEditModal()"></div>
        <div
            class="bg-white rounded-2xl w-full max-w-lg p-8 relative z-10 max-h-[90vh] overflow-y-auto shadow-2xl ring-1 ring-slate-900/5">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-bold text-slate-800">Edit Profile</h2>
                <button onclick="resetProfile()" class="text-xs font-medium text-red-500 hover:underline"
                    data-i18n="p5_reset">Reset
                </button>
            </div>

            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-slate-400 mb-1 ml-1" data-i18n="p5_cover_url">Cover Image
                        URL</label>
                    <input id="in-cover" type="text" placeholder="https://..."
                        class="w-full p-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-indigo-400 focus:ring-1 focus:ring-indigo-400 outline-none text-sm font-medium">
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs font-bold text-slate-400 mb-1 ml-1">Name</label>
                        <input id="in-name" type="text"
                            class="w-full p-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-indigo-400 focus:ring-1 focus:ring-indigo-400 outline-none text-sm font-medium">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-400 mb-1 ml-1">Age</label>
                        <input id="in-age" type="text"
                            class="w-full p-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-indigo-400 focus:ring-1 focus:ring-indigo-400 outline-none text-sm font-medium">
                    </div>
                </div>

                <div>
                    <label class="block text-xs font-bold text-slate-400 mb-1 ml-1">Tagline</label>
                    <input id="in-tagline" type="text"
                        class="w-full p-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-indigo-400 focus:ring-1 focus:ring-indigo-400 outline-none text-sm font-medium">
                </div>

                <div class="grid grid-cols-3 gap-2">
                    <input id="in-tag1" type="text" placeholder="Tag 1"
                        class="w-full p-2 rounded-xl bg-slate-50 border border-slate-200 text-sm">
                    <input id="in-tag2" type="text" placeholder="Tag 2"
                        class="w-full p-2 rounded-xl bg-slate-50 border border-slate-200 text-sm">
                    <input id="in-tag3" type="text" placeholder="Tag 3"
                        class="w-full p-2 rounded-xl bg-slate-50 border border-slate-200 text-sm">
                </div>

                <div class="hidden">

                    <input id="in-fb"><input id="in-ig"><input id="in-dc">
                </div>
            </div>

            <div class="mt-8 flex justify-end gap-3">
                <button onclick="closeEditModal()"
                    class="px-5 py-2 rounded-xl font-medium text-slate-500 hover:bg-slate-100 transition-colors">Cancel</button>
                <button onclick="saveProfile()"
                    class="px-6 py-2 rounded-xl font-bold text-white bg-indigo-600 hover:bg-indigo-700 shadow-md shadow-indigo-200 transition-all">Save
                    Changes</button>
            </div>
        </div>
    </div>


    <div id="project-modal" class="fixed inset-0 z-[60] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm" onclick="closeProjectModal()"></div>
        <div class="bg-white rounded-2xl w-full max-w-2xl p-8 relative z-10 shadow-2xl flex flex-col max-h-[90vh]">
            <div class="flex justify-between items-center mb-6 shrink-0">
                <h2 class="text-xl font-bold text-slate-800">Update Work</h2>
                <button onclick="addProjectRow()"
                    class="flex items-center gap-1 text-sm font-bold text-indigo-600 hover:bg-indigo-50 px-3 py-1.5 rounded-lg transition-colors">
                    <i data-lucide="plus" width="16"></i> Add Project
                </button>
            </div>

            <div id="project-edit-list" class="space-y-4 overflow-y-auto pr-2 custom-scrollbar flex-1">

            </div>

            <div class="mt-6 flex justify-end gap-3 shrink-0 pt-4 border-t border-slate-100">
                <button onclick="closeProjectModal()"
                    class="px-4 py-2 rounded-xl font-medium text-slate-500 hover:bg-slate-100">Cancel</button>
                <button onclick="saveProjects()"
                    class="px-5 py-2 rounded-xl font-bold text-white bg-slate-900 hover:bg-slate-800 shadow-lg">Update
                    All</button>
            </div>
        </div>
    </div>



    <div id="appt-modal" class="fixed inset-0 z-[60] hidden flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm" onclick="closeApptModal()"></div>
        <div class="bg-white rounded-2xl w-full max-w-sm p-6 relative z-10 shadow-2xl">
            <h2 class="text-xl font-bold text-slate-800 mb-4">New Event</h2>
            <input id="appt-title" type="text" placeholder="What's happening?"
                class="w-full p-3 rounded-xl bg-slate-50 border border-slate-200 outline-none font-bold text-slate-700 mb-2">
            <div class="flex gap-2 mb-2">
                <input id="appt-date" type="date"
                    class="w-1/2 p-2 rounded-xl bg-slate-50 border border-slate-200 text-sm text-slate-600">
                <input id="appt-time" type="text" placeholder="23:59" maxlength="5" oninput="formatTime(this)"
                    class="w-1/2 p-2 rounded-xl bg-slate-50 border border-slate-200 text-sm text-slate-600 text-center font-mono">
            </div>
            <input id="appt-loc" type="text" placeholder="Where? (e.g. Cafe)"
                class="w-full p-2 rounded-xl bg-slate-50 border border-slate-200 text-sm text-slate-600 mb-4">

            <div class="flex gap-2 justify-center mb-6">
                <button onclick="selectColor('indigo')"
                    class="w-8 h-8 rounded-full bg-indigo-500 hover:ring-4 ring-indigo-200 transition-all"></button>
                <button onclick="selectColor('pink')"
                    class="w-8 h-8 rounded-full bg-pink-500 hover:ring-4 ring-pink-200 transition-all"></button>
                <button onclick="selectColor('orange')"
                    class="w-8 h-8 rounded-full bg-orange-500 hover:ring-4 ring-orange-200 transition-all"></button>
                <button onclick="selectColor('emerald')"
                    class="w-8 h-8 rounded-full bg-emerald-500 hover:ring-4 ring-emerald-200 transition-all"></button>
            </div>
            <input type="hidden" id="appt-color" value="indigo">

            <div class="flex justify-end gap-3">
                <button onclick="closeApptModal()"
                    class="px-4 py-2 rounded-xl font-medium text-slate-500 hover:bg-slate-100">Cancel</button>
                <button onclick="saveAppt()"
                    class="px-5 py-2 rounded-xl font-bold text-white bg-indigo-600 hover:bg-indigo-700 shadow-md">Add
                    Event</button>
            </div>
        </div>
    </div>



    <div id="chatbot-container"></div>
    <script src="../js/chatbot.js"></script>


    <script>
        lucide.createIcons();
        const currentLang = localStorage.getItem('raven_lang') || 'th';


        function getDefaults() {
            const isTh = currentLang === 'th';
            return {
                name: isTh ? "‡πÄ‡∏£‡πÄ‡∏ß‡∏ô" : "Raven",
                tagline: isTh ? "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•" : "Building Digital Experiences",
                tag1: isTh ? "üíª ‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤" : "üíª Developer",
                tag2: isTh ? "üéì ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ SPU" : "üéì SPU Student",
                tag3: isTh ? "üìç ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø" : "üìç Bangkok",
                bio: isTh ? "‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ú‡∏π‡πâ‡∏´‡∏•‡∏á‡πÉ‡∏´‡∏•‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ú‡∏™‡∏°‡∏ú‡∏™‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏á‡πà‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏°‡∏∏‡πà‡∏á‡πÄ‡∏ô‡πâ‡∏ô‡πÑ‡∏õ‡∏ó‡∏µ‡πà React ‡πÅ‡∏•‡∏∞ AI Integration" : "Passionate CS student exploring the intersection of design and technology. I build web applications that are fast, accessible, and visually engaging. currently focused on React and AI integration.",
                age: "22",
                status: isTh ? "‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô" : "Open to Work",
                fb: "#", ig: "#", dc: "#",
                cover: "https://images.unsplash.com/photo-1579546929518-9e396f3cc809?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80",
                skills: ["JavaScript", "React", "Node.js", "Python", "TailwindCSS", "Figma", "Git"],
                projects: [
                    { name: isTh ? "‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÇ‡∏ü‡∏•‡∏¥‡πÇ‡∏≠ V7" : "Portfolio V7", desc: isTh ? "‡∏™‡∏î‡πÉ‡∏™ & ‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢" : "Modern & Vivid", link: "#" },
                    { name: isTh ? "E-Commerce API" : "E-Commerce API", desc: "Node.js Microservice", link: "#" }
                ],
                experience: [
                    { title: isTh ? "‡∏ô‡∏±‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏≠‡∏¥‡∏™‡∏£‡∏∞" : "Freelance Web Developer", type: isTh ? "‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß ¬∑ ‡∏û‡∏≤‡∏£‡πå‡∏ó‡πÑ‡∏ó‡∏°‡πå" : "Self-Employed ¬∑ Part-time", date: isTh ? "‡∏°.‡∏Ñ. 2023 - ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô" : "Jan 2023 - Present ¬∑ Bangkok", desc: isTh ? "‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏°‡∏±‡∏¢‡πÉ‡∏´‡∏°‡πà ‡πÄ‡∏ä‡πà‡∏ô React, TailwindCSS ‡πÅ‡∏•‡∏∞ Node.js" : "Developing custom web solutions using modern tech stack including React, TailwindCSS, and Node.js.", icon: "code-2", bg: "bg-slate-100", text: "text-slate-500" },
                    { title: isTh ? "‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ CS" : "CS Student", type: isTh ? "‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏®‡∏£‡∏µ‡∏õ‡∏ó‡∏∏‡∏° ¬∑ ‡πÄ‡∏ï‡πá‡∏°‡πÄ‡∏ß‡∏•‡∏≤" : "Sripatum University ¬∑ Full-time", date: "2022 - 2026", desc: "", icon: "S", bg: "bg-orange-50", text: "text-orange-600", isText: true }
                ]
            };
        }

        function getProfileData() {
            const saved = JSON.parse(localStorage.getItem('raven_profile')) || {};

        }

        function loadProfile() {
            const data = getProfileData();


            const coverEl = document.getElementById('p-cover');
            if (coverEl && data.cover) {
                coverEl.style.backgroundImage = `url('${data.cover}')`;
            }

            ['name', 'tagline', 'tag1', 'tag2', 'tag3', 'bio', 'age', 'status'].forEach(id => {
                const el = document.getElementById('p-' + id);
                if (el) el.innerText = data[id];
            });


            const skillContainer = document.getElementById('p-skills');
            const colors = [
                'bg-indigo-50 text-indigo-600 border-indigo-100',
                'bg-pink-50 text-pink-600 border-pink-100',
                'bg-blue-50 text-blue-600 border-blue-100',
                'bg-emerald-50 text-emerald-600 border-emerald-100'
            ];

            if (skillContainer) {
                const skills = data.skills || getDefaults().skills;
                skillContainer.innerHTML = skills.map((s, i) => `
                    <span class="px-3 py-1 rounded-full text-xs font-bold border ${colors[i % colors.length]} cursor-default hover:opacity-80 transition-opacity">
                        ${s}
                    </span>
                `).join('');
            }


            const expContainer = document.getElementById('p-exp');
            const exps = data.experience || getDefaults().experience;
            if (expContainer) {
                expContainer.innerHTML = exps.map((e, i) => `
                    <div class="flex gap-4 border-b border-slate-100 pb-4 last:border-0 last:pb-0 group">
                        <div class="w-12 h-12 ${e.bg} rounded-lg flex items-center justify-center shrink-0 border border-slate-200">
                            ${e.isText ? `<span class="${e.text} font-bold">${e.icon}</span>` : `<i data-lucide="${e.icon}" class="${e.text}"></i>`}
                        </div>
                        <div class="flex-1">
                            <h3 class="font-bold text-base text-slate-900">${e.title}</h3>
                            <p class="text-sm text-slate-700">${e.type}</p>
                            <p class="text-xs text-slate-500 mt-1">${e.date}</p>
                            ${e.desc ? `<p class="text-sm text-slate-600 mt-2">${e.desc}</p>` : ''}
                        </div>
                        <div class="flex gap-2 self-start mt-1 transition opacity-0 group-hover:opacity-100 admin-only">
                            <button onclick="openExpModal('${e.title}')" class="text-slate-300 hover:text-blue-600"><i data-lucide="pencil" width="14"></i></button>
                            <button onclick="deleteExp(${i})" class="text-slate-300 hover:text-red-500"><i data-lucide="trash-2" width="14"></i></button>
                        </div>
                    </div>
                `).join('');
            }

            checkGuestMode();
        }

        function checkGuestMode() {
            const isGuest = localStorage.getItem('isGuest') === 'true';
            if (isGuest) {
                document.body.classList.add('guest-active');


                if (!document.getElementById('guest-style-enforcer')) {
                    const style = document.createElement('style');
                    style.id = 'guest-style-enforcer';
                    style.innerHTML = `
                        .guest-active .admin-only,
                        .guest-active button[onclick*="delete"],
                        .guest-active button[onclick*="remove"],
                        .guest-active button[onclick*="save"],
                        .guest-active button[onclick*="Edit"], 
                        .guest-active button[onclick*="Project"],
                        .guest-active button[onclick*="Appt"],
                        .guest-active button[onclick*="Exp"],
                        .guest-active .lucide-pencil,
                        .guest-active .lucide-trash-2,
                        .guest-active .lucide-plus,
                        .guest-active #btn-add-exp,
                        .guest-active .project-row button {
                            display: none !important;
                        }
                    `;
                    document.head.appendChild(style);
                }


                const manualSelectors = [


                ];
                manualSelectors.forEach(sel => {
                    document.querySelectorAll(sel).forEach(el => el.style.display = 'none');
                });
            }
        }


        function openExpModal(titleToEdit = null) {
            const t = (k) => window.TRANSLATIONS && window.TRANSLATIONS[currentLang] ? window.TRANSLATIONS[currentLang][k] : k;
            const data = getProfileData();
            let exps = data.experience || getDefaults().experience;


            if (!titleToEdit && !confirm(t("p5_exp_add_confirm"))) return;

            let idx = exps.findIndex(e => e.title === titleToEdit);
            if (idx === -1) {

                exps.unshift({
                    title: t("p5_exp_def_title"),
                    type: t("p5_exp_def_type"),
                    date: t("p5_exp_def_date"),
                    desc: t("p5_exp_def_desc"),
                    icon: "briefcase", bg: "bg-slate-100", text: "text-slate-500"
                });
                idx = 0;
            }

            const item = exps[idx];

            const html = `
                <div class="space-y-3">
                    <input id="sw-title" value="${item.title}" class="w-full p-2 border rounded-lg text-sm" placeholder="${t('p5_modal_title')}">
                    <input id="sw-type" value="${item.type}" class="w-full p-2 border rounded-lg text-sm" placeholder="Type">
                    <input id="sw-date" value="${item.date}" class="w-full p-2 border rounded-lg text-sm" placeholder="${t('p5_modal_date')}">
                    <textarea id="sw-desc" rows="3" class="w-full p-2 border rounded-lg text-sm" placeholder="${t('p5_exp_def_desc')}">${item.desc}</textarea>
                    <div class="flex gap-2">
                         <button onclick="deleteExp(${idx})" class="text-red-500 text-xs font-bold hover:underline">Delete Item</button>
                    </div>
                </div>
                <button onclick="saveExp(${idx})" class="mt-4 w-full py-2 bg-slate-900 text-white font-bold rounded-xl">Save Changes</button>
            `;

            showActionModal("Edit Experience", html);
        }

        function saveExp(idx) {
            const data = getProfileData();
            const exps = data.experience || getDefaults().experience;
            const t = (k) => window.TRANSLATIONS && window.TRANSLATIONS[currentLang] ? window.TRANSLATIONS[currentLang][k] : k;

            if (exps[idx]) {
                exps[idx].title = document.getElementById('sw-title').value;
                exps[idx].type = document.getElementById('sw-type').value;
                exps[idx].date = document.getElementById('sw-date').value;
                exps[idx].desc = document.getElementById('sw-desc').value;
            }

            data.experience = exps;
            localStorage.setItem('raven_profile', JSON.stringify(data));

            document.querySelector('.fixed.inset-0').remove();
            loadProfile();
            showToast(t("p5_exp_saved"));
        }

        function deleteExp(idx) {
            const t = (k) => window.TRANSLATIONS && window.TRANSLATIONS[currentLang] ? window.TRANSLATIONS[currentLang][k] : k;
            if (confirm(t("p5_exp_del_confirm"))) {
                const data = getProfileData();
                const exps = data.experience || getDefaults().experience;
                exps.splice(idx, 1);
                data.experience = exps;
                localStorage.setItem('raven_profile', JSON.stringify(data));


                const modal = document.querySelector('.fixed.inset-0');
                if (modal && !modal.classList.contains('hidden')) modal.remove();

                loadProfile();
                showToast(t("p5_exp_deleted"));
            }
        }


        const modal = document.getElementById('edit-modal');
        function openEditModal() {
            const data = getProfileData();

            ['name', 'tagline', 'tag1', 'tag2', 'tag3', 'age', 'status', 'fb', 'ig', 'dc'].forEach(id => {
                const el = document.getElementById('in-' + id);
                if (el) el.value = data[id] || '';
            });

            const coverIn = document.getElementById('in-cover');
            if (coverIn) coverIn.value = data.cover || "";

            modal.classList.remove('hidden');
        }
        function closeEditModal() { modal.classList.add('hidden'); }

        function saveProfile() {
            const current = getProfileData();
            const newData = { ...current };

            ['name', 'tagline', 'tag1', 'tag2', 'tag3', 'age', 'status', 'fb', 'ig', 'dc'].forEach(id => {
                const el = document.getElementById('in-' + id);
                if (el) newData[id] = el.value;
            });


            const coverIn = document.getElementById('in-cover');
            if (coverIn) newData.cover = coverIn.value;

            localStorage.setItem('raven_profile', JSON.stringify(newData));
            loadProfile();
            closeEditModal();
        }


        function openAboutModal() {
            const data = getProfileData();
            const html = `
                <div class="space-y-3">
                    <label class="block text-xs font-bold text-slate-500">About Me</label>
                    <textarea id="mod-bio" rows="6" class="w-full p-3 border rounded-xl bg-slate-50 focus:ring-2 focus:ring-indigo-200 outline-none text-sm leading-relaxed">${data.bio || ''}</textarea>
                </div>
                <button onclick="saveAbout()" class="mt-4 w-full py-2 bg-slate-900 text-white font-bold rounded-xl hover:bg-black transition">Save About</button>
            `;
            showActionModal("Edit About Me", html);
        }

        function saveAbout() {
            const data = getProfileData();
            data.bio = document.getElementById('mod-bio').value;
            localStorage.setItem('raven_profile', JSON.stringify(data));
            loadProfile();

        }

        function openSkillsModal() {
            const data = getProfileData();
            const html = `
                <div class="space-y-3">
                    <label class="block text-xs font-bold text-slate-500">Skills (Comma separated)</label>
                    <textarea id="mod-skills" rows="4" class="w-full p-3 border rounded-xl bg-slate-50 focus:ring-2 focus:ring-indigo-200 outline-none text-sm leading-relaxed">${(data.skills || []).join(', ')}</textarea>
                </div>
                <button onclick="saveSkills()" class="mt-4 w-full py-2 bg-slate-900 text-white font-bold rounded-xl hover:bg-black transition">Save Skills</button>
            `;
            showActionModal("Edit Skills", html);
        }

        function saveSkills() {
            const data = getProfileData();
            const val = document.getElementById('mod-skills').value;
            data.skills = val.split(',').map(s => s.trim()).filter(s => s);
            localStorage.setItem('raven_profile', JSON.stringify(data));
            loadProfile();
            document.querySelector('.fixed.inset-0').remove();
        }

        function resetProfile() {
            if (confirm("Reset profile data?")) {
                localStorage.removeItem('raven_profile');
                localStorage.removeItem('raven_appts');
                loadProfile();
                loadAppts();
                closeEditModal();
            }
        }


        const pModal = document.getElementById('project-modal');
        const pList = document.getElementById('project-edit-list');

        function openProjectModal() {
            const data = getProfileData();
            const projs = data.projects || getDefaults().projects;


            pList.innerHTML = '';


            projs.forEach(p => addProjectRow(p.name, p.desc, p.link, p.img));


            if (projs.length === 0) addProjectRow();

            pModal.classList.remove('hidden');
            checkGuestMode();
        }

        function closeProjectModal() { pModal.classList.add('hidden'); }

        function addProjectRow(name = '', desc = '', link = '', img = '') {
            const div = document.createElement('div');
            div.className = 'project-row p-4 bg-slate-50 rounded-xl border border-slate-200 flex flex-col gap-2 relative group';
            div.innerHTML = `
                <div class="flex justify-between items-center">
                    <h4 class="text-xs font-bold text-slate-400 uppercase">Project Item</h4>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-red-400 hover:text-red-600 transition-colors"><i data-lucide="trash-2" width="14"></i></button>
                </div>
                <input type="text" class="in-p-name w-full p-2 rounded-lg bg-white border border-slate-200 text-sm focus:border-indigo-400 outline-none" placeholder="Project Name" value="${name}">
                <input type="text" class="in-p-desc w-full p-2 rounded-lg bg-white border border-slate-200 text-sm focus:border-indigo-400 outline-none" placeholder="Description" value="${desc}">
                <input type="text" class="in-p-link w-full p-2 rounded-lg bg-white border border-slate-200 text-sm focus:border-indigo-400 outline-none" placeholder="Link URL (GitHub/Web)" value="${link}">
                <input type="text" class="in-p-img w-full p-2 rounded-lg bg-white border border-slate-200 text-sm focus:border-indigo-400 outline-none" placeholder="Image URL (for Index Recent)" value="${img}">
            `;
            pList.appendChild(div);
            lucide.createIcons();
        }

        function saveProjects() {
            const rows = document.querySelectorAll('.project-row');
            const newProjects = [];

            rows.forEach(row => {
                const name = row.querySelector('.in-p-name').value.trim();
                const desc = row.querySelector('.in-p-desc').value.trim();
                const link = row.querySelector('.in-p-link').value.trim();
                const img = row.querySelector('.in-p-img').value.trim();


                newProjects.push({ name, desc, link, img });
            });

            const current = getProfileData();
            current.projects = newProjects;
            localStorage.setItem('raven_profile', JSON.stringify(current));

            loadProfile();
            closeProjectModal();
            showToast(currentLang === 'th' ? '‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß!' : 'Projects Updated!');
        }



        const apptDefaults = [
            { title: "Team Sync", date: "Today", time: "10:00", loc: "Zoom", color: "indigo" },
            { title: "Design Sprint", date: "Tomorrow", time: "14:00", loc: "Studio", color: "pink" }
        ];

        function loadAppts() {
            let appts = JSON.parse(localStorage.getItem('raven_appts') || JSON.stringify(apptDefaults));


            const list = document.getElementById('appt-list');
            if (list) {
                if (appts.length === 0) list.innerHTML = `<div class="text-center text-slate-400 text-sm py-8">No appointments found.</div>`;
                else {
                    list.innerHTML = appts.map((a, i) => {
                        const colorMap = {
                            'pink': 'bg-pink-500',
                            'indigo': 'bg-indigo-500',
                            'orange': 'bg-orange-500',
                            'emerald': 'bg-emerald-500'
                        };
                        const dotColor = colorMap[a.color] || colorMap['indigo'];

                        return `
                    <div class="card-modern p-4 flex items-center justify-between group">
                        <div class="flex items-center gap-4">
                            <div class="flex flex-col items-center justify-center w-12 h-12 bg-slate-50 rounded-xl text-slate-600 font-bold border border-slate-100">
                                <span class="text-[9px] uppercase tracking-wide text-slate-400">DEC</span>
                                <span class="text-lg leading-none">${Math.floor(Math.random() * 30) + 1}</span>
                            </div>
                            
                            <div>
                                <h4 class="font-bold text-slate-800 text-sm group-hover:text-indigo-600 transition-colors">${a.title}</h4>
                                <div class="flex items-center gap-3 text-xs text-slate-400 mt-1">
                                    <span class="flex items-center gap-1"><i data-lucide="clock" width="12"></i> ${a.time}</span>
                                    <span class="flex items-center gap-1"><i data-lucide="map-pin" width="12"></i> ${a.loc}</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                             <div class="w-2 h-2 rounded-full ${dotColor}"></div>
                             <button onclick="deleteAppt(${i})" class="text-slate-300 hover:text-red-500 transition-colors"><i data-lucide="trash-2" width="16"></i></button>
                        </div>
                    </div>
                `}).join('');
                }
            }

            const projContainer = document.getElementById('p-projects');
            const data = getProfileData();
            const projs = data.projects || defaults.projects;

            if (projContainer) {
                projContainer.innerHTML = projs.map((p, i) => {
                    const bg = i === 0 ? 'bg-indigo-50' : 'bg-pink-50';
                    const text = i === 0 ? 'text-indigo-600' : 'text-pink-600';
                    const icon = i === 0 ? 'layout' : 'code-2';

                    return `
                <div class="card-modern p-5 group relative flex items-center justify-between hover:bg-slate-50 transition-colors">
                    <div class="flex items-center gap-4 cursor-pointer" onclick="window.open('${p.link}', '_blank')">
                        <div class="w-12 h-12 rounded-xl ${bg} ${text} flex items-center justify-center">
                            <i data-lucide="${icon}" width="20"></i>
                        </div>
                        <div>
                            <h4 class="font-bold text-slate-800 group-hover:text-indigo-600 transition-colors">${p.name}</h4>
                            <p class="text-xs text-slate-500 mt-0.5">${p.desc}</p>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <div class="w-8 h-8 rounded-full bg-white border border-slate-100 text-slate-300 flex items-center justify-center group-hover:border-indigo-200 group-hover:text-indigo-500 transition-all cursor-pointer" onclick="window.open('${p.link}', '_blank')">
                            <i data-lucide="arrow-up-right" width="16"></i>
                        </div>
                         <button onclick="deleteProject(${i})" class="w-8 h-8 rounded-full bg-transparent text-slate-300 flex items-center justify-center hover:text-red-500 hover:bg-red-50 transition-all opacity-0 group-hover:opacity-100 z-10" title="Delete Project">
                            <i data-lucide="trash-2" width="16"></i>
                        </button>
                    </div>
                </div>
            `}).join('');
            }

            lucide.createIcons();
        }

        function deleteProject(idx) {
            const t = (k) => window.TRANSLATIONS && window.TRANSLATIONS[currentLang] ? window.TRANSLATIONS[currentLang][k] : k;
            if (confirm(t("p5_proj_del_confirm"))) {
                const data = getProfileData();
                const projs = data.projects || getDefaults().projects;
                projs.splice(idx, 1);
                data.projects = projs;
                localStorage.setItem('raven_profile', JSON.stringify(data));
                loadProfile();
                showToast(t("p5_exp_deleted").replace("Experience", "Project").replace("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", "‡∏ú‡∏•‡∏á‡∏≤‡∏ô")); // Reuse or simple replace
            }
        }

        // Appt Modals
        const aModal = document.getElementById('appt-modal');
        function openApptModal() { aModal.classList.remove('hidden'); }
        function closeApptModal() { aModal.classList.add('hidden'); }
        function selectColor(c) { document.getElementById('appt-color').value = c; }

        function saveAppt() {
            // Simple logic for prototype
            const newA = {
                title: document.getElementById('appt-title').value || "New Event",
                date: "TBA",
                time: document.getElementById('appt-time').value || "09:00",
                loc: document.getElementById('appt-loc').value || "Online",
                color: document.getElementById('appt-color').value
            };
            const appts = JSON.parse(localStorage.getItem('raven_appts') || JSON.stringify(apptDefaults));
            appts.push(newA);
            localStorage.setItem('raven_appts', JSON.stringify(appts));
            loadAppts();
            closeApptModal();
        }

        function deleteAppt(i) {
            if (confirm("Delete this event?")) {
                const appts = JSON.parse(localStorage.getItem('raven_appts') || JSON.stringify(apptDefaults));
                appts.splice(i, 1);
                localStorage.setItem('raven_appts', JSON.stringify(appts));
                loadAppts();
            }
        }

        // More Menu Logic
        function openMoreMenu() {
            const t = (k) => window.TRANSLATIONS && window.TRANSLATIONS[currentLang] ? window.TRANSLATIONS[currentLang][k] : k;
            const isTh = currentLang === 'th';

            const actions = [
                {
                    icon: 'link',
                    label: isTh ? '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå' : 'Copy Profile Link',
                    desc: isTh ? '‡πÅ‡∏ä‡∏£‡πå‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì' : 'Share your profile URL',
                    click: "shareProfile()"
                },
                {
                    icon: 'image',
                    label: t('p5_save_img'),
                    desc: isTh ? '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (.png)' : 'Save as Image (.png)',
                    click: "saveProfileImage()"
                },
                {
                    icon: 'qr-code',
                    label: isTh ? '‡∏£‡∏´‡∏±‡∏™ QR' : 'QR Code',
                    desc: isTh ? '‡∏™‡∏£‡πâ‡∏≤‡∏á QR ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πÅ‡∏Å‡∏ô' : 'Generate scan code',
                    click: "showQRCode()"
                }
            ];

            const html = actions.map(a => `
                <button onclick="${a.click}; closeActionModal()" class="w-full flex items-center gap-4 p-4 hover:bg-slate-50 rounded-xl transition-colors text-left group">
                    <div class="w-10 h-10 rounded-full bg-slate-100 text-slate-500 flex items-center justify-center group-hover:bg-indigo-100 group-hover:text-indigo-600 transition-colors">
                        <i data-lucide="${a.icon}" width="20"></i>
                    </div>
                    <div>
                        <h4 class="font-bold text-slate-800 text-sm">${a.label}</h4>
                        <p class="text-xs text-slate-500">${a.desc}</p>
                    </div>
                </button>
            `).join('');

            showActionModal(isTh ? '‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£' : 'Actions', html);
        }

        function shareProfile() {
            const isTh = currentLang === 'th';
            navigator.clipboard.writeText(window.location.href).then(() => {
                showToast(isTh ? "‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏•‡πâ‡∏ß!" : "Link Copied!");
            }).catch(err => {
                console.error('Failed to copy: ', err);
                showToast(isTh ? "‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à" : "Failed to copy", "error");
            });
        }

        function showQRCode() {
            const isTh = currentLang === 'th';
            // Generate QR that opens in Guest Mode
            const baseUrl = window.location.origin + window.location.pathname.replace(/[^\/]*$/, '');
            const guestUrl = `${baseUrl}login.html?guest=true`;
            const qrSrc = `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=${encodeURIComponent(guestUrl)}`;

            const html = `
                <div class="flex flex-col items-center justify-center p-2 pb-4">
                    <div class="bg-white p-2 rounded-xl border border-slate-100 mb-4 shadow-sm">
                        <img src="${qrSrc}" alt="QR Code" class="w-48 h-48 rounded-lg">
                    </div>
                    <p class="text-sm text-slate-500 text-center max-w-[200px] leading-relaxed">
                        ${isTh ? '‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏ú‡∏π‡πâ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°' : 'Scan to visit in Guest Mode'}
                    </p>
                </div>
            `;

            // Allow small delay for modal close if called from menu
            setTimeout(() => {
                showActionModal(isTh ? '‡∏£‡∏´‡∏±‡∏™ QR' : 'QR Code', html);
            }, 100);
        }

        function showActionModal(title, contentHTML) {
            // Close existing if any
            closeActionModal();

            const modal = document.createElement('div');
            modal.id = 'dynamic-action-modal';
            modal.className = 'fixed inset-0 z-[60] flex items-end sm:items-center justify-center p-4';
            modal.innerHTML = `
                <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm transition-opacity" onclick="closeActionModal()"></div>
                <div class="bg-white w-full max-w-sm rounded-2xl p-6 relative z-10 shadow-2xl animate-up">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold text-slate-800">${title}</h3>
                        <button onclick="closeActionModal()" class="w-8 h-8 rounded-full bg-slate-50 text-slate-400 flex items-center justify-center hover:bg-slate-100 hover:text-slate-600 transition-colors">
                            <i data-lucide="x" width="16"></i>
                        </button>
                    </div>
                    <div class="space-y-1">
                        ${contentHTML}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            lucide.createIcons();
        }

        function closeActionModal() {
            const m = document.getElementById('dynamic-action-modal');
            if (m) m.remove();
        }

        // --- UI Utilities (Toast & Modal) ---
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            const bgClass = type === 'success' ? 'bg-slate-800' : 'bg-red-500';
            toast.className = `fixed bottom-6 left-1/2 -translate-x-1/2 ${bgClass} text-white px-6 py-3 rounded-full shadow-xl flex items-center gap-3 z-[60] transition-all duration-300 opacity-0 translate-y-10`;
            toast.innerHTML = `<i data-lucide="${type === 'success' ? 'check-circle' : 'alert-circle'}" width="18"></i> <span class="font-medium text-sm">${message}</span>`;

            document.body.appendChild(toast);
            lucide.createIcons();

            // Animate In
            setTimeout(() => toast.classList.remove('opacity-0', 'translate-y-10'), 10);

            // Animate Out
            setTimeout(() => {
                toast.classList.add('opacity-0', 'translate-y-10');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }



        // --- Authenticated Actions ---
        function toggleOpenWork() {
            const btn = document.getElementById('btn-open-work');
            const isWorking = btn.classList.contains('bg-blue-600');

            if (isWorking) {
                btn.classList.remove('bg-blue-600', 'text-white', 'hover:bg-blue-700', 'shadow-blue-200');
                btn.classList.add('bg-slate-200', 'text-slate-500', 'hover:bg-slate-300');
                btn.innerText = window.TRANSLATIONS && window.TRANSLATIONS[currentLang] ? (currentLang === 'th' ? '‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô' : 'Not Open') : 'Not Open';
                showToast(currentLang === 'th' ? '‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß' : 'Status: Not looking for work');
            } else {
                btn.classList.add('bg-blue-600', 'text-white', 'hover:bg-blue-700', 'shadow-blue-200');
                btn.classList.remove('bg-slate-200', 'text-slate-500', 'hover:bg-slate-300');
                btn.innerText = window.TRANSLATIONS && window.TRANSLATIONS[currentLang] ? (currentLang === 'th' ? '‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô' : 'Open to work') : 'Open to work';
                showToast(currentLang === 'th' ? 'üìå ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß!' : 'üöÄ You are Open to Work!');
            }
        }

        function shareProfile() {
            const dummyUrl = "https://ravenport.com/profile/raven";
            navigator.clipboard.writeText(dummyUrl).then(() => {
                showToast(currentLang === 'th' ? '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!' : 'Link Copied to Clipboard!');
            });
        }

        function showFullSchedule() {
            const appts = JSON.parse(localStorage.getItem('raven_appts') || JSON.stringify(apptDefaults));
            const t = (k) => window.TRANSLATIONS && window.TRANSLATIONS[currentLang] ? window.TRANSLATIONS[currentLang][k] : k;

            // Table Header Translations
            const hTime = currentLang === 'th' ? "‡πÄ‡∏ß‡∏•‡∏≤" : "Time";
            const hEvent = currentLang === 'th' ? "‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°" : "Event";
            const hLoc = currentLang === 'th' ? "‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà" : "Location";
            const hDate = currentLang === 'th' ? "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà" : "Date";

            const rows = appts.map(a => `
                <tr class="border-b border-slate-100 hover:bg-slate-50 transition-colors">
                    <td class="py-3 px-4 text-sm font-bold text-slate-600 whitespace-nowrap">
                        <div class="flex items-center gap-2">
                            <i data-lucide="clock" width="14" class="text-slate-400"></i> ${a.time}
                        </div>
                    </td>
                    <td class="py-3 px-4">
                        <div class="font-bold text-slate-800">${a.title}</div>
                        <div class="text-xs text-${a.color}-500 font-medium bg-${a.color}-50 inline-block px-1.5 py-0.5 rounded mt-0.5 max-w-fit">
                            ${a.color.charAt(0).toUpperCase() + a.color.slice(1)}
                        </div>
                    </td>
                    <td class="py-3 px-4 text-sm text-slate-600">
                        <div class="flex items-center gap-2">
                             <i data-lucide="map-pin" width="14" class="text-slate-400"></i> ${a.loc}
                        </div>
                    </td>
                     <td class="py-3 px-4 text-sm text-slate-500">${a.date}</td>
                </tr>
            `).join('');

            const tableHtml = `
                <div class="overflow-x-auto rounded-xl border border-slate-200">
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="bg-slate-50 border-b border-slate-200 text-xs uppercase text-slate-500 font-bold tracking-wider">
                                <th class="py-3 px-4">${hTime}</th>
                                <th class="py-3 px-4">${hEvent}</th>
                                <th class="py-3 px-4">${hLoc}</th>
                                <th class="py-3 px-4">${hDate}</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white">
                            ${rows.length > 0 ? rows : `<tr><td colspan="4" class="p-4 text-center text-slate-400 text-sm">No events found.</td></tr>`}
                        </tbody>
                    </table>
                </div>
                <div class="mt-4 flex justify-end">
                    <button onclick="openApptModal(); document.querySelector('.fixed.inset-0').remove();" class="flex items-center gap-2 text-sm font-bold text-indigo-600 hover:text-indigo-700 hover:bg-indigo-50 px-4 py-2 rounded-lg transition-colors">
                        <i data-lucide="plus" width="16"></i> ${t('p5_add')}
                    </button>
                </div>
            `;

            // Use a custom modal width by overriding styles temporarily or just use a wider container div
            // Since showActionModal is narrow (max-w-sm), we might want a new function or modify showActionModal.
            // Let's modify showActionModal to accept a size class or create a new internal helper.
            // For now, let's just use showActionModal but with a hack to make it wider if needed, 
            // OR better: Create a new specific modal for this since user asked for "Beautiful".

            showScheduleModal(currentLang === 'th' ? "‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î" : "Full Schedule", tableHtml);
        }

        function showScheduleModal(title, htmlContent) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 z-[70] flex items-center justify-center p-4 opacity-0 transition-opacity duration-300';
            modal.innerHTML = `
                <div class="absolute inset-0 bg-slate-900/40 backdrop-blur-sm transition-opacity" onclick="this.parentElement.remove()"></div>
                <div class="bg-white rounded-2xl w-full max-w-2xl p-6 relative z-10 shadow-2xl transform scale-95 transition-transform duration-300">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-slate-800">${title}</h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-slate-400 hover:text-slate-600"><i data-lucide="x" width="20"></i></button>
                    </div>
                    <div class="text-slate-600 text-sm leading-relaxed space-y-3">
                        ${htmlContent}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);

            // Animate
            requestAnimationFrame(() => {
                modal.classList.remove('opacity-0');
                modal.querySelector('div.bg-white').classList.remove('scale-95');
                modal.querySelector('div.bg-white').classList.add('scale-100');
                lucide.createIcons();
            });
        }

        // Init
        loadProfile();
        loadAppts();
        checkGuestMode();
        function saveProfileImage() {
            showToast(currentLang === 'th' ? "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û..." : "Generating Image...", "success");

            // Small delay to let toast show
            setTimeout(() => {
                // Target the main profile column (Identity, About, Projects, Experience)
                const element = document.getElementById('profile-main-col');

                if (element) {
                    html2canvas(element, {
                        useCORS: true,
                        scale: 2,
                        backgroundColor: "#ffffff"
                    }).then(canvas => {
                        const link = document.createElement('a');
                        link.download = 'raven-profile.png';
                        link.href = canvas.toDataURL();
                        link.click();
                        showToast(currentLang === 'th' ? "‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!" : "Image Downloaded!");
                    });
                } else {
                    // Fallback to body if card not found
                    html2canvas(document.body).then(canvas => {
                        const link = document.createElement('a');
                        link.download = 'raven-profile-full.png';
                        link.href = canvas.toDataURL();
                        link.click();
                    });
                }
            }, 500);
        }

        // Time Formatter (Force 24h)
        function formatTime(input) {
            // 1. Remove non-numbers
            let v = input.value.replace(/[^0-9]/g, '');

            // 2. Limit length to 4 digits (HHMM)
            if (v.length > 4) v = v.substring(0, 4);

            // 3. Auto-insert colon
            if (v.length > 2) {
                v = v.substring(0, 2) + ':' + v.substring(2);
            }

            // 4. Update value
            input.value = v;

            // 5. Validation (Optional visual feedback)
            if (v.length === 5) {
                const [h, m] = v.split(':').map(Number);
                if (h > 23 || m > 59) {
                    input.classList.add('text-red-500');
                } else {
                    input.classList.remove('text-red-500');
                }
            } else {
                input.classList.remove('text-red-500');
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</body>

</html>